diff --git a/src/Session/GoogleAccount.php b/src/Session/GoogleAccount.php
new file mode 100644
index 0000000..b5ce58f
--- /dev/null
+++ b/src/Session/GoogleAccount.php
@@ -0,0 +1,62 @@
+<?php
+
+/*
+ * Copyright 2015 Google Inc. All Rights Reserved.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+namespace Google\Cloud\Samples\Bookshelf\Session;
+
+use Symfony\Component\HttpFoundation\Cookie;
+use Symfony\Component\HttpFoundation\Request;
+
+/**
+ * class SessionUser represents an authenticated user in the browser session
+ */
+// [START google_account]
+class GoogleAccount
+{
+    public $id;
+    public $name;
+    public $imageUrl;
+
+    public function __construct($id = null, $name = null, $imageUrl = null)
+    {
+        $this->id = $id;
+        $this->name = $name;
+        $this->imageUrl = $imageUrl;
+    }
+
+    public function getLoggedIn()
+    {
+        return !empty($this->id);
+    }
+
+    public static function createFromRequest(Request $request)
+    {
+        if ($userInfo = $request->cookies->get('google_user_info')) {
+            $userInfo = json_decode($userInfo, true);
+
+            return new GoogleAccount($userInfo['sub'], $userInfo['name'], $userInfo['picture']);
+        }
+
+        return new GoogleAccount;
+    }
+
+    public static function createCookie(array $userInfo)
+    {
+        return new Cookie('google_user_info', json_encode($userInfo));
+    }
+}
+// [END google_account]
\ No newline at end of file
diff --git a/src/app.php b/src/app.php
index cf1c569..e85551d 100644
--- a/src/app.php
+++ b/src/app.php
@@ -24,6 +24,7 @@ use Silex\Application;
 use Silex\Provider\TwigServiceProvider;
 use Silex\Provider\UrlGeneratorServiceProvider;
 use Symfony\Component\Yaml\Yaml;
+use Google\Cloud\Samples\Bookshelf\Session\GoogleAccount;
 
 $app = new Application();
 
@@ -35,9 +36,19 @@ $app->register(new TwigServiceProvider(), array(
     ),
 ));
 
+// register the url generator
+$app->register(new UrlGeneratorServiceProvider);
+
 // parse configuration
 $app['config'] = Yaml::parse(file_get_contents(__DIR__ . '/../config/settings.yml'));
 
+// create the user object
+// [START create_user]
+$app['user'] = function ($app) {
+  return GoogleAccount::createFromRequest($app['request']);
+};
+// [END create_user]
+
 // create the google authorization client
 $app['google_client'] = function ($app) {
   /** @var Symfony\Component\Routing\Generator\UrlGenerator $urlGen */
diff --git a/src/controllers.php b/src/controllers.php
index 2c57d7b..fedd753 100644
--- a/src/controllers.php
+++ b/src/controllers.php
@@ -21,11 +21,11 @@ namespace Google\Cloud\Samples\Bookshelf;
 /*
  * Adds all the controllers to $app.  Follows Silex Skeleton pattern.
  */
-use Symfony\Component\HttpFoundation\Cookie;
 use Symfony\Component\HttpFoundation\Request;
 use Symfony\Component\HttpFoundation\Response;
 use Google\Cloud\Samples\Bookshelf\DataModel\DataModelInterface;
 use Google\Cloud\Samples\Bookshelf\FileSystem\CloudStorage;
+use Google\Cloud\Samples\Bookshelf\Session\GoogleAccount;
 
 $app->get('/', function (Request $request) use ($app) {
     return $app->redirect('/books/');
@@ -75,6 +75,10 @@ $app->post('/books/add', function (Request $request) use ($app) {
     if (!empty($book['publishedDate'])) {
         $book['publishedDate'] = date('c', strtotime($book['publishedDate']));
     }
+    if ($app['user']->getLoggedIn()) {
+        $book['createdBy'] = $app['user']->name;
+        $book['createdById'] = $app['user']->id;
+    }
     $id = $model->create($book);
 
     return $app->redirect("/books/$id");
@@ -162,3 +166,53 @@ $app->post('/books/{id}/delete', function ($id) use ($app) {
     }
 );
 // [END delete]
+
+# [START login]
+$app->get('/login', function () use ($app) {
+    /** @var Google_Client $client */
+    $client = $app['google_client'];
+
+    $scopes = [ \Google_Service_Oauth2::USERINFO_PROFILE ];
+    $authUrl = $client->createAuthUrl($scopes);
+
+    return $app->redirect($authUrl);
+})->bind('login');
+# [END login]
+
+# [START login_callback]
+$app->get('/login/callback', function () use ($app) {
+    /** @var Request $request */
+    $request = $app['request'];
+
+    if (!$code = $request->query->get('code')) {
+        return new Response('Code required', Response::HTTP_BAD_REQUEST);
+    }
+
+    /** @var Google_Client $client */
+    $client = $app['google_client'];
+    $authResponse = $client->fetchAccessTokenWithAuthCode($code);
+
+    if ($client->getAccessToken()) {
+        $userInfo = $client->verifyIdToken();
+
+        // set the user info in a cookie and redirect to the homepage
+        $response = new Response('', Response::HTTP_FOUND, ['Location' => '/']);
+        $response->headers->setCookie(GoogleAccount::createCookie($userInfo));
+
+        return $response;
+    }
+
+    // an error occured while trying to authorize - display it
+    return new Response($authResponse['error_description'], 400);
+
+})->bind('login_callback');
+# [END login_callback]
+
+# [START logout]
+$app->get('/logout', function () use ($app) {
+    $response = new Response('', Response::HTTP_FOUND, ['Location' => '/']);
+    $response->headers->clearCookie('google_user_info');
+
+    return $response;
+})->bind('logout');
+# [END logout]
diff --git a/templates/base.html.twig b/templates/base.html.twig
index db1be8f..7ddcf37 100644
--- a/templates/base.html.twig
+++ b/templates/base.html.twig
@@ -30,6 +30,22 @@
         <ul class="nav navbar-nav">
           <li><a href="/books">Books</a></li>
         </ul>
+        <p class="navbar-text navbar-right">
+          {# [START login] #}
+          {% if app.user.loggedIn %}
+            {% if app.user.imageUrl %}
+              <img src="{{ app.user.imageUrl }}" class="img-circle" width="24" alt="Photo" />
+            {% endif %}
+            <span>
+              {{ app.user.name }} &nbsp;
+              <a href="/logout">(logout)</a>
+            </span>
+          {% else %}
+            <a href="/login">Login</a>
+          {% endif %}
+          {# [END login] #}
+        </p>
+
       </div>
     </div>
     <div class="container">
diff --git a/test/functional/ControllersTest.php b/test/functional/ControllersTest.php
index a959177..0fb184b 100644
--- a/test/functional/ControllersTest.php
+++ b/test/functional/ControllersTest.php
@@ -210,4 +210,86 @@ class ControllersTest extends WebTestCase
         $client->submit($submitButton->form());
         $this->assertEquals(404, $client->getResponse()->getStatusCode());
     }
+
+    public function testLogin()
+    {
+        $client = $this->createClient();
+        $crawler = $client->request('GET', '/books/');
+        $loginLink = $crawler->filter('a:contains("Login")')->link();
+
+        $crawler = $client->click($loginLink);
+        $response = $client->getResponse();
+        $this->assertEquals(302, $response->getStatusCode());
+        $url = $response->headers->get('Location');
+        $this->assertNotNull($url);
+
+        $parts = parse_url($url);
+        parse_str($parts['query'], $query);
+
+        $this->assertArrayHasKey('response_type', $query);
+        $this->assertArrayHasKey('client_id', $query);
+        $this->assertArrayHasKey('redirect_uri', $query);
+        $this->assertArrayHasKey('state', $query);
+        $this->assertArrayHasKey('scope', $query);
+
+        $this->assertEquals('code', $query['response_type']);
+        $this->assertEquals('http://localhost/login/callback', $query['redirect_uri']);
+    }
+
+    public function testLoginCallback()
+    {
+        $client = $this->createClient();
+        $crawler = $client->request('GET', '/login/callback');
+
+        $response = $client->getResponse();
+        $this->assertEquals(400, $response->getStatusCode());
+        $this->assertEquals('Code required', (string) $response->getContent());
+
+        $crawler = $client->request('GET', '/login/callback?code=123');
+
+        $response = $client->getResponse();
+        $this->assertEquals(400, $response->getStatusCode());
+
+        $idToken = ['sub' => 'fake-id'];
+        $googleClient = $this->getMock('Google_Client');
+        $googleClient->expects($this->once())
+            ->method('fetchAccessTokenWithAuthCode')
+            ->will($this->returnValue(true));
+        $googleClient->expects($this->once())
+            ->method('getAccessToken')
+            ->will($this->returnValue(['access_token' => 'xyz']));
+        $googleClient->expects($this->once())
+            ->method('verifyIdToken')
+            ->will($this->returnValue($idToken));
+
+        $this->app['google_client'] = $googleClient;
+        $crawler = $client->request('GET', '/login/callback?code=123');
+        $response = $client->getResponse();
+        $cookies = $response->headers->getCookies();
+
+        $this->assertEquals(1, count($cookies));
+        $this->assertEquals('google_user_info', $cookies[0]->getName());
+        $this->assertEquals(json_encode($idToken), $cookies[0]->getValue());
+    }
+
+    public function testLogout()
+    {
+        $client = $this->createClient();
+
+        // set the logged-in user info on the request
+        $userInfo = [
+            'sub' => 'fake-id',
+        ];
+        $cookie = new Cookie('google_user_info', json_encode($userInfo));
+        $client->getCookieJar()->set($cookie);
+
+        // make the request
+        $crawler = $client->request('GET', '/logout');
+        $response = $client->getResponse();
+        $cookies = $response->headers->getCookies();
+
+        $this->assertEquals(1, count($cookies));
+        $this->assertEquals('google_user_info', $cookies[0]->getName());
+        $this->assertNull($cookies[0]->getValue());
+    }
 }
diff --git a/test/unit/Session/GoogleAccountTest.php b/test/unit/Session/GoogleAccountTest.php
new file mode 100644
index 0000000..2150d76
--- /dev/null
+++ b/test/unit/Session/GoogleAccountTest.php
@@ -0,0 +1,70 @@
+<?php
+/*
+ * Copyright 2015 Google Inc. All Rights Reserved.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+namespace Google\Cloud\Samples\Bookshelf\Session;
+
+use Symfony\Component\HttpFoundation\Request;
+
+class GoogleAccountTest extends \PHPUnit_Framework_TestCase
+{
+    public function testLoggedIn()
+    {
+        $id = 'fake-id';
+        $user = new GoogleAccount($id);
+
+        $this->assertTrue($user->getLoggedIn());
+        $this->assertNull($user->name);
+        $this->assertNull($user->imageUrl);
+    }
+
+    public function testNotLoggedIn()
+    {
+        $user = new GoogleAccount();
+
+        $this->assertFalse($user->getLoggedIn());
+        $this->assertNull($user->name);
+        $this->assertNull($user->imageUrl);
+    }
+
+    public function testCreateFromRequest()
+    {
+        $userInfo = [
+            'sub'       => 'fake-id',
+            'name'      => 'Test Guy',
+            'picture'   => 'http://fa.ke/image.jpg',
+        ];
+
+        $request = new Request();
+        $request->cookies->set('google_user_info', json_encode($userInfo));
+
+        $user = GoogleAccount::createFromRequest($request);
+
+        $this->assertTrue($user->getLoggedIn());
+        $this->assertEquals($userInfo['sub'], $user->id);
+        $this->assertEquals($userInfo['name'], $user->name);
+        $this->assertEquals($userInfo['picture'], $user->imageUrl);
+    }
+
+    public function testCreateFromRequestWithoutCookie()
+    {
+        $request = new Request();
+        $user = GoogleAccount::createFromRequest($request);
+
+        $this->assertFalse($user->getLoggedIn());
+        $this->assertNull($user->name);
+        $this->assertNull($user->imageUrl);
+    }
+}
