diff --git a/.dockerignore b/.dockerignore
deleted file mode 100644
index 305612c..0000000
--- a/.dockerignore
+++ /dev/null
@@ -1,2 +0,0 @@
-test/*
-coverage/*
diff --git a/Dockerfile b/Dockerfile
deleted file mode 100644
index a0aa4aa..0000000
--- a/Dockerfile
+++ /dev/null
@@ -1,14 +0,0 @@
-# The Google App Engine php runtime is Debian Jessie with PHP installed
-# and various os-level packages to allow installation of popular PHP
-# libraries. The source is on github at:
-#   https://github.com/GoogleCloudPlatform/php-docker
-FROM gcr.io/google_appengine/php
-
-# Add our NGINX and php.ini config
-ENV DOCUMENT_ROOT=${APP_DIR}/web \
-    NGINX_CONF_INCLUDE=config/nginx-app.conf \
-    PHP_INI_OVERRIDE=config/php-app.ini
-
-# Workaround for AUFS-related permission issue:
-# See https://github.com/docker/docker/issues/783#issuecomment-56013588
-RUN cp -R ${APP_DIR} ${APP_DIR}-copy; rm -r ${APP_DIR}; mv ${APP_DIR}-copy ${APP_DIR}; chmod -R 550 ${APP_DIR}; chown -R root.www-data ${APP_DIR}
diff --git a/Dockerfile.worker b/Dockerfile.worker
deleted file mode 100644
index 906848a..0000000
--- a/Dockerfile.worker
+++ /dev/null
@@ -1,11 +0,0 @@
-# The Google App Engine php runtime is Debian Jessie with PHP installed
-# and various os-level packages to allow installation of popular PHP
-# libraries. The source is on github at:
-#   https://github.com/GoogleCloudPlatform/php-docker
-FROM gcr.io/google_appengine/php
-
-# Add our php.ini config
-ENV PHP_INI_OVERRIDE=config/php-pubsub.ini
-
-# override the default CMD for the pubsub worker
-CMD php bin/pubsub/entrypoint.php
diff --git a/README.md b/README.md
index bfb95a5..9d89dda 100644
--- a/README.md
+++ b/README.md
@@ -1,8 +1,8 @@
-# 8 - Deploying to Google Container Engine
+# Deploying to Google Compute Engine
 
-This folder contains the sample code for the [Deploying to Google Container Engine][tutorial-gke]
+This folder contains the sample code for the [Deploying to Google Compute Engine][tutorial-gce]
 tutorial. Please refer to the tutorial for instructions on configuring, running,
 and deploying this sample.
 
-[tutorial-gke]: https://cloud.google.com/php/tutorials/bookshelf-on-container-engine
+[tutorial-gce]: https://cloud.google.com/php/getting-started/run-on-compute-engine
 
diff --git a/app.yaml b/app.yaml
deleted file mode 100644
index 50261f7..0000000
--- a/app.yaml
+++ /dev/null
@@ -1,11 +0,0 @@
-runtime: php
-vm: true
-
-runtime_config:
-  document_root: web
-
-# [START overrides]
-env_variables:
-  NGINX_CONF_INCLUDE: config/nginx-app.conf
-  PHP_INI_OVERRIDE: config/php-app.ini
-# [END overrides]
diff --git a/bookshelf-frontend.yaml b/bookshelf-frontend.yaml
deleted file mode 100644
index 041b17c..0000000
--- a/bookshelf-frontend.yaml
+++ /dev/null
@@ -1,33 +0,0 @@
-# This file configures the bookshelf application frontend. The frontend serves
-# public web traffic.
-
-apiVersion: extensions/v1beta1
-kind: Deployment
-metadata:
-  name: bookshelf-frontend
-  labels:
-    app: bookshelf
-# The bookshelf frontend replica set ensures that at least 3
-# instances of the bookshelf app are running on the cluster.
-# For more info about Pods see:
-#   https://cloud.google.com/container-engine/docs/pods/
-spec:
-  replicas: 3
-  template:
-    metadata:
-      labels:
-        app: bookshelf
-        tier: frontend
-    spec:
-      containers:
-      - name: bookshelf-app
-        # Replace $GCLOUD_PROJECT with your project ID or use `make template`.
-        image: gcr.io/$GCLOUD_PROJECT/bookshelf
-        # This setting makes nodes pull the docker image every time before
-        # starting the pod. This is useful when debugging, but should be turned
-        # off in production.
-        imagePullPolicy: Always
-        # The bookshelf process listens on port 8080 for web traffic by default.
-        ports:
-        - name: http-server
-          containerPort: 8080
diff --git a/bookshelf-service.yaml b/bookshelf-service.yaml
deleted file mode 100644
index 45290ce..0000000
--- a/bookshelf-service.yaml
+++ /dev/null
@@ -1,23 +0,0 @@
-
-# The bookshelf service provides a load-balancing proxy over the bookshelf
-# frontend pods. By specifying the type as a 'LoadBalancer', Container Engine
-# will create an external HTTP load balancer.
-# For more information about Services see:
-#   https://cloud.google.com/container-engine/docs/services/
-# For more information about external HTTP load balancing see:
-#   https://cloud.google.com/container-engine/docs/load-balancer
-apiVersion: v1
-kind: Service
-metadata:
-  name: bookshelf-frontend
-  labels:
-    app: bookshelf
-    tier: frontend
-spec:
-  type: LoadBalancer
-  ports:
-  - port: 80
-    targetPort: http-server
-  selector:
-    app: bookshelf
-    tier: frontend
diff --git a/bookshelf-worker.yaml b/bookshelf-worker.yaml
deleted file mode 100644
index a5c0af3..0000000
--- a/bookshelf-worker.yaml
+++ /dev/null
@@ -1,47 +0,0 @@
-# Copyright 2015 Google Inc.
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-#     http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License
-
-# This file configures the bookshelf task worker. The worker is responsible
-# for processing book requests and updating book information.
-
-apiVersion: extensions/v1beta1
-kind: Deployment
-metadata:
-  name: bookshelf-worker
-  labels:
-    app: bookshelf
-# The bookshelf worker replica set ensures that at least 2 instances of the
-# bookshelf worker pod are running on the cluster.
-# For more info about Pods see:
-#   https://cloud.google.com/container-engine/docs/pods/
-spec:
-  replicas: 2
-  template:
-    metadata:
-      labels:
-        app: bookshelf
-        tier: worker
-    spec:
-      containers:
-      - name: bookshelf-app
-        # Replace $GCLOUD_PROJECT with your project ID or use `make template`.
-        image: gcr.io/$GCLOUD_PROJECT/bookshelf-worker
-        # This setting makes nodes pull the docker image every time before
-        # starting the pod. This is useful when debugging, but should be turned
-        # off in production.
-        imagePullPolicy: Always
-        # The bookshelf process listens on port 8080 for web traffic by default.
-        ports:
-        - name: ratchet-server
-          containerPort: 8080
diff --git a/composer.lock b/composer.lock
index 7d258cb..4d0597d 100644
--- a/composer.lock
+++ b/composer.lock
@@ -146,34 +146,37 @@
         },
         {
             "name": "google/apiclient",
-            "version": "v2.0.0-RC7",
+            "version": "dev-master",
             "source": {
                 "type": "git",
                 "url": "https://github.com/google/google-api-php-client.git",
-                "reference": "998067619ce59a849948b0a8647499b90f70ab41"
+                "reference": "feab52d4907589c7140ba6bb96894db8ec601378"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/google/google-api-php-client/zipball/998067619ce59a849948b0a8647499b90f70ab41",
-                "reference": "998067619ce59a849948b0a8647499b90f70ab41",
+                "url": "https://api.github.com/repos/google/google-api-php-client/zipball/feab52d4907589c7140ba6bb96894db8ec601378",
+                "reference": "feab52d4907589c7140ba6bb96894db8ec601378",
                 "shasum": ""
             },
             "require": {
                 "firebase/php-jwt": "~2.0|~3.0",
                 "google/apiclient-services": "*@dev",
-                "google/auth": "0.7",
+                "google/auth": "0.9",
                 "guzzlehttp/guzzle": "~5.2|~6.0",
-                "guzzlehttp/psr7": "1.2.*",
+                "guzzlehttp/psr7": "^1.2",
                 "monolog/monolog": "^1.17",
                 "php": ">=5.4",
-                "phpseclib/phpseclib": "~2.0",
-                "psr/http-message": "1.0.*"
+                "phpseclib/phpseclib": "~2.0"
             },
             "require-dev": {
                 "phpunit/phpunit": "~4",
                 "squizlabs/php_codesniffer": "~2.3",
-                "symfony/css-selector": "~2.0",
-                "symfony/dom-crawler": "~2.0"
+                "symfony/css-selector": "~2.1",
+                "symfony/dom-crawler": "~2.1",
+                "tedivm/stash": "^0.14.1"
+            },
+            "suggest": {
+                "tedivm/stash": "For caching certs and tokens (using Google_Client::setCache)"
             },
             "type": "library",
             "extra": {
@@ -198,21 +201,21 @@
             "keywords": [
                 "google"
             ],
-            "time": "2016-03-15 18:55:57"
+            "time": "2016-06-08 23:08:49"
         },
         {
             "name": "google/apiclient-services",
-            "version": "v0.2",
+            "version": "v0.3",
             "target-dir": "Google/Service",
             "source": {
                 "type": "git",
                 "url": "https://github.com/google/google-api-php-client-services.git",
-                "reference": "b33ee2a338e7e68cf56491da2c0690ef50f8f99b"
+                "reference": "b2faa3d37da789be2cdcf0c5acae3896a0cda958"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/google/google-api-php-client-services/zipball/b33ee2a338e7e68cf56491da2c0690ef50f8f99b",
-                "reference": "b33ee2a338e7e68cf56491da2c0690ef50f8f99b",
+                "url": "https://api.github.com/repos/google/google-api-php-client-services/zipball/b2faa3d37da789be2cdcf0c5acae3896a0cda958",
+                "reference": "b2faa3d37da789be2cdcf0c5acae3896a0cda958",
                 "shasum": ""
             },
             "require": {
@@ -233,31 +236,32 @@
             "keywords": [
                 "google"
             ],
-            "time": "2016-05-17 15:34:22"
+            "time": "2016-06-02 18:58:36"
         },
         {
             "name": "google/auth",
-            "version": "v0.7",
+            "version": "v0.9",
             "source": {
                 "type": "git",
                 "url": "https://github.com/google/google-auth-library-php.git",
-                "reference": "f3288860ce7b3076a6768e4ff7b85e0f6100e221"
+                "reference": "47c3c6bece495e58381a21fed13a735bd23a51cc"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/google/google-auth-library-php/zipball/f3288860ce7b3076a6768e4ff7b85e0f6100e221",
-                "reference": "f3288860ce7b3076a6768e4ff7b85e0f6100e221",
+                "url": "https://api.github.com/repos/google/google-auth-library-php/zipball/47c3c6bece495e58381a21fed13a735bd23a51cc",
+                "reference": "47c3c6bece495e58381a21fed13a735bd23a51cc",
                 "shasum": ""
             },
             "require": {
                 "firebase/php-jwt": "~2.0|~3.0",
-                "guzzlehttp/guzzle": "~5.2|~6.0",
-                "guzzlehttp/psr7": "1.2.*",
+                "guzzlehttp/guzzle": "~5.3|~6.0",
+                "guzzlehttp/psr7": "~1.2",
                 "php": ">=5.4",
-                "psr/http-message": "1.0.*"
+                "psr/cache": "^1.0",
+                "psr/http-message": "^1.0"
             },
             "require-dev": {
-                "phplint/phplint": "0.0.1",
+                "friendsofphp/php-cs-fixer": "^1.11",
                 "phpunit/phpunit": "3.7.*"
             },
             "type": "library",
@@ -280,7 +284,7 @@
                 "google",
                 "oauth2"
             ],
-            "time": "2016-03-03 02:03:58"
+            "time": "2016-06-01 22:07:52"
         },
         {
             "name": "google/cloud",
@@ -288,16 +292,16 @@
             "source": {
                 "type": "git",
                 "url": "https://github.com/GoogleCloudPlatform/gcloud-php.git",
-                "reference": "880f758ec404fb933389c8b1a5e210544c9da3db"
+                "reference": "9bec8050f7c22ac3f05691a163f633ac05cb501b"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/GoogleCloudPlatform/gcloud-php/zipball/880f758ec404fb933389c8b1a5e210544c9da3db",
-                "reference": "880f758ec404fb933389c8b1a5e210544c9da3db",
+                "url": "https://api.github.com/repos/GoogleCloudPlatform/gcloud-php/zipball/9bec8050f7c22ac3f05691a163f633ac05cb501b",
+                "reference": "9bec8050f7c22ac3f05691a163f633ac05cb501b",
                 "shasum": ""
             },
             "require": {
-                "google/auth": "0.7",
+                "google/auth": "0.9",
                 "guzzlehttp/guzzle": "~5.2|~6.0",
                 "guzzlehttp/psr7": "1.2.*",
                 "monolog/monolog": "~1",
@@ -308,6 +312,7 @@
             "require-dev": {
                 "phpdocumentor/phpdocumentor": "2.8.*",
                 "phpunit/phpunit": "4.8.*",
+                "satooshi/php-coveralls": "~1.0",
                 "squizlabs/php_codesniffer": "2.*"
             },
             "type": "library",
@@ -342,7 +347,7 @@
                 "google cloud",
                 "google cloud platform"
             ],
-            "time": "2016-05-16 15:35:09"
+            "time": "2016-06-07 18:04:35"
         },
         {
             "name": "guzzle/common",
@@ -797,16 +802,16 @@
         },
         {
             "name": "phpseclib/phpseclib",
-            "version": "2.0.1",
+            "version": "2.0.2",
             "source": {
                 "type": "git",
                 "url": "https://github.com/phpseclib/phpseclib.git",
-                "reference": "ba6fb78f727cd09f2a649113b95468019e490585"
+                "reference": "3d265f7c079f5b37d33475f996d7a383c5fc8aeb"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/phpseclib/phpseclib/zipball/ba6fb78f727cd09f2a649113b95468019e490585",
-                "reference": "ba6fb78f727cd09f2a649113b95468019e490585",
+                "url": "https://api.github.com/repos/phpseclib/phpseclib/zipball/3d265f7c079f5b37d33475f996d7a383c5fc8aeb",
+                "reference": "3d265f7c079f5b37d33475f996d7a383c5fc8aeb",
                 "shasum": ""
             },
             "require": {
@@ -826,6 +831,9 @@
             },
             "type": "library",
             "autoload": {
+                "files": [
+                    "phpseclib/bootstrap.php"
+                ],
                 "psr-4": {
                     "phpseclib\\": "phpseclib/"
                 }
@@ -882,7 +890,7 @@
                 "x.509",
                 "x509"
             ],
-            "time": "2016-01-18 17:07:21"
+            "time": "2016-05-13 01:15:21"
         },
         {
             "name": "pimple/pimple",
@@ -931,6 +939,52 @@
             "time": "2013-11-22 08:30:29"
         },
         {
+            "name": "psr/cache",
+            "version": "1.0.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/php-fig/cache.git",
+                "reference": "9e66031f41fbbdda45ee11e93c45d480ccba3eb3"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/php-fig/cache/zipball/9e66031f41fbbdda45ee11e93c45d480ccba3eb3",
+                "reference": "9e66031f41fbbdda45ee11e93c45d480ccba3eb3",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">=5.3.0"
+            },
+            "type": "library",
+            "extra": {
+                "branch-alias": {
+                    "dev-master": "1.0.x-dev"
+                }
+            },
+            "autoload": {
+                "psr-4": {
+                    "Psr\\Cache\\": "src/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "PHP-FIG",
+                    "homepage": "http://www.php-fig.org/"
+                }
+            ],
+            "description": "Common interface for caching libraries",
+            "keywords": [
+                "cache",
+                "psr",
+                "psr-6"
+            ],
+            "time": "2015-12-11 02:52:07"
+        },
+        {
             "name": "psr/http-message",
             "version": "1.0",
             "source": {
@@ -1273,16 +1327,16 @@
         },
         {
             "name": "symfony/debug",
-            "version": "v3.0.6",
+            "version": "v3.1.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/debug.git",
-                "reference": "a06d10888a45afd97534506afb058ec38d9ba35b"
+                "reference": "26786e21ee0344f99629215ead5f0d6f18cdc267"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/debug/zipball/a06d10888a45afd97534506afb058ec38d9ba35b",
-                "reference": "a06d10888a45afd97534506afb058ec38d9ba35b",
+                "url": "https://api.github.com/repos/symfony/debug/zipball/26786e21ee0344f99629215ead5f0d6f18cdc267",
+                "reference": "26786e21ee0344f99629215ead5f0d6f18cdc267",
                 "shasum": ""
             },
             "require": {
@@ -1299,7 +1353,7 @@
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "3.0-dev"
+                    "dev-master": "3.1-dev"
                 }
             },
             "autoload": {
@@ -1326,20 +1380,20 @@
             ],
             "description": "Symfony Debug Component",
             "homepage": "https://symfony.com",
-            "time": "2016-03-30 10:41:14"
+            "time": "2016-06-06 15:08:54"
         },
         {
             "name": "symfony/event-dispatcher",
-            "version": "v3.0.6",
+            "version": "v3.0.7",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/event-dispatcher.git",
-                "reference": "807dde98589f9b2b00624dca326740380d78dbbc"
+                "reference": "2bd63cc8b94882084565d2ec3fae5b8d6878398b"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/event-dispatcher/zipball/807dde98589f9b2b00624dca326740380d78dbbc",
-                "reference": "807dde98589f9b2b00624dca326740380d78dbbc",
+                "url": "https://api.github.com/repos/symfony/event-dispatcher/zipball/2bd63cc8b94882084565d2ec3fae5b8d6878398b",
+                "reference": "2bd63cc8b94882084565d2ec3fae5b8d6878398b",
                 "shasum": ""
             },
             "require": {
@@ -1386,20 +1440,20 @@
             ],
             "description": "Symfony EventDispatcher Component",
             "homepage": "https://symfony.com",
-            "time": "2016-05-05 06:56:13"
+            "time": "2016-06-06 11:33:26"
         },
         {
             "name": "symfony/http-foundation",
-            "version": "v3.0.6",
+            "version": "v3.0.7",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/http-foundation.git",
-                "reference": "18b24bc32d2495ae79d76e777368786a6536fe31"
+                "reference": "d268a643884f85e91d6ba11ca68de96833f3f6e5"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/http-foundation/zipball/18b24bc32d2495ae79d76e777368786a6536fe31",
-                "reference": "18b24bc32d2495ae79d76e777368786a6536fe31",
+                "url": "https://api.github.com/repos/symfony/http-foundation/zipball/d268a643884f85e91d6ba11ca68de96833f3f6e5",
+                "reference": "d268a643884f85e91d6ba11ca68de96833f3f6e5",
                 "shasum": ""
             },
             "require": {
@@ -1439,20 +1493,20 @@
             ],
             "description": "Symfony HttpFoundation Component",
             "homepage": "https://symfony.com",
-            "time": "2016-04-12 18:09:53"
+            "time": "2016-06-06 11:33:26"
         },
         {
             "name": "symfony/http-kernel",
-            "version": "v3.0.6",
+            "version": "v3.0.7",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/http-kernel.git",
-                "reference": "6a5010978edf0a9646342232531e53bfc7abbcd3"
+                "reference": "97cc1c15e3406e7a2adf14ad6b0e41a04d4a6fc4"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/http-kernel/zipball/6a5010978edf0a9646342232531e53bfc7abbcd3",
-                "reference": "6a5010978edf0a9646342232531e53bfc7abbcd3",
+                "url": "https://api.github.com/repos/symfony/http-kernel/zipball/97cc1c15e3406e7a2adf14ad6b0e41a04d4a6fc4",
+                "reference": "97cc1c15e3406e7a2adf14ad6b0e41a04d4a6fc4",
                 "shasum": ""
             },
             "require": {
@@ -1521,7 +1575,7 @@
             ],
             "description": "Symfony HttpKernel Component",
             "homepage": "https://symfony.com",
-            "time": "2016-05-09 22:13:13"
+            "time": "2016-06-06 16:52:35"
         },
         {
             "name": "symfony/polyfill-mbstring",
@@ -1584,16 +1638,16 @@
         },
         {
             "name": "symfony/routing",
-            "version": "v3.0.6",
+            "version": "v3.0.7",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/routing.git",
-                "reference": "a6cd168310066176599442aa21f5da86c3f8e0b3"
+                "reference": "c780454838a1131adc756d737a4b4cc1d18f8c64"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/routing/zipball/a6cd168310066176599442aa21f5da86c3f8e0b3",
-                "reference": "a6cd168310066176599442aa21f5da86c3f8e0b3",
+                "url": "https://api.github.com/repos/symfony/routing/zipball/c780454838a1131adc756d737a4b4cc1d18f8c64",
+                "reference": "c780454838a1131adc756d737a4b4cc1d18f8c64",
                 "shasum": ""
             },
             "require": {
@@ -1655,20 +1709,20 @@
                 "uri",
                 "url"
             ],
-            "time": "2016-05-03 12:23:49"
+            "time": "2016-05-30 06:58:27"
         },
         {
             "name": "symfony/yaml",
-            "version": "v3.0.6",
+            "version": "v3.1.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/yaml.git",
-                "reference": "0047c8366744a16de7516622c5b7355336afae96"
+                "reference": "c5a7e7fc273c758b92b85dcb9c46149ccda89623"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/yaml/zipball/0047c8366744a16de7516622c5b7355336afae96",
-                "reference": "0047c8366744a16de7516622c5b7355336afae96",
+                "url": "https://api.github.com/repos/symfony/yaml/zipball/c5a7e7fc273c758b92b85dcb9c46149ccda89623",
+                "reference": "c5a7e7fc273c758b92b85dcb9c46149ccda89623",
                 "shasum": ""
             },
             "require": {
@@ -1677,7 +1731,7 @@
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "3.0-dev"
+                    "dev-master": "3.1-dev"
                 }
             },
             "autoload": {
@@ -1704,20 +1758,20 @@
             ],
             "description": "Symfony Yaml Component",
             "homepage": "https://symfony.com",
-            "time": "2016-03-04 07:55:57"
+            "time": "2016-06-14 11:18:07"
         },
         {
             "name": "twig/twig",
-            "version": "v1.24.0",
+            "version": "v1.24.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/twigphp/Twig.git",
-                "reference": "3e5aa30ebfbafd5951fb1b01e338e1800ce7e0e8"
+                "reference": "3566d311a92aae4deec6e48682dc5a4528c4a512"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/twigphp/Twig/zipball/3e5aa30ebfbafd5951fb1b01e338e1800ce7e0e8",
-                "reference": "3e5aa30ebfbafd5951fb1b01e338e1800ce7e0e8",
+                "url": "https://api.github.com/repos/twigphp/Twig/zipball/3566d311a92aae4deec6e48682dc5a4528c4a512",
+                "reference": "3566d311a92aae4deec6e48682dc5a4528c4a512",
                 "shasum": ""
             },
             "require": {
@@ -1765,7 +1819,7 @@
             "keywords": [
                 "templating"
             ],
-            "time": "2016-01-25 21:22:18"
+            "time": "2016-05-30 09:11:59"
         }
     ],
     "packages-dev": [
@@ -2042,38 +2096,135 @@
             "time": "2015-11-05 12:58:44"
         },
         {
+            "name": "phpdocumentor/reflection-common",
+            "version": "1.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/phpDocumentor/ReflectionCommon.git",
+                "reference": "144c307535e82c8fdcaacbcfc1d6d8eeb896687c"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/phpDocumentor/ReflectionCommon/zipball/144c307535e82c8fdcaacbcfc1d6d8eeb896687c",
+                "reference": "144c307535e82c8fdcaacbcfc1d6d8eeb896687c",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">=5.5"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "^4.6"
+            },
+            "type": "library",
+            "extra": {
+                "branch-alias": {
+                    "dev-master": "1.0.x-dev"
+                }
+            },
+            "autoload": {
+                "psr-4": {
+                    "phpDocumentor\\Reflection\\": [
+                        "src"
+                    ]
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Jaap van Otterdijk",
+                    "email": "opensource@ijaap.nl"
+                }
+            ],
+            "description": "Common reflection classes used by phpdocumentor to reflect the code structure",
+            "homepage": "http://www.phpdoc.org",
+            "keywords": [
+                "FQSEN",
+                "phpDocumentor",
+                "phpdoc",
+                "reflection",
+                "static analysis"
+            ],
+            "time": "2015-12-27 11:43:31"
+        },
+        {
             "name": "phpdocumentor/reflection-docblock",
-            "version": "2.0.4",
+            "version": "3.1.0",
             "source": {
                 "type": "git",
                 "url": "https://github.com/phpDocumentor/ReflectionDocBlock.git",
-                "reference": "d68dbdc53dc358a816f00b300704702b2eaff7b8"
+                "reference": "9270140b940ff02e58ec577c237274e92cd40cdd"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/phpDocumentor/ReflectionDocBlock/zipball/d68dbdc53dc358a816f00b300704702b2eaff7b8",
-                "reference": "d68dbdc53dc358a816f00b300704702b2eaff7b8",
+                "url": "https://api.github.com/repos/phpDocumentor/ReflectionDocBlock/zipball/9270140b940ff02e58ec577c237274e92cd40cdd",
+                "reference": "9270140b940ff02e58ec577c237274e92cd40cdd",
                 "shasum": ""
             },
             "require": {
-                "php": ">=5.3.3"
+                "php": ">=5.5",
+                "phpdocumentor/reflection-common": "^1.0@dev",
+                "phpdocumentor/type-resolver": "^0.2.0",
+                "webmozart/assert": "^1.0"
             },
             "require-dev": {
-                "phpunit/phpunit": "~4.0"
+                "mockery/mockery": "^0.9.4",
+                "phpunit/phpunit": "^4.4"
             },
-            "suggest": {
-                "dflydev/markdown": "~1.0",
-                "erusev/parsedown": "~1.0"
+            "type": "library",
+            "autoload": {
+                "psr-4": {
+                    "phpDocumentor\\Reflection\\": [
+                        "src/"
+                    ]
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Mike van Riel",
+                    "email": "me@mikevanriel.com"
+                }
+            ],
+            "description": "With this component, a library can provide support for annotations via DocBlocks or otherwise retrieve information that is embedded in a DocBlock.",
+            "time": "2016-06-10 09:48:41"
+        },
+        {
+            "name": "phpdocumentor/type-resolver",
+            "version": "0.2",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/phpDocumentor/TypeResolver.git",
+                "reference": "b39c7a5b194f9ed7bd0dd345c751007a41862443"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/phpDocumentor/TypeResolver/zipball/b39c7a5b194f9ed7bd0dd345c751007a41862443",
+                "reference": "b39c7a5b194f9ed7bd0dd345c751007a41862443",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">=5.5",
+                "phpdocumentor/reflection-common": "^1.0"
+            },
+            "require-dev": {
+                "mockery/mockery": "^0.9.4",
+                "phpunit/phpunit": "^5.2||^4.8.24"
             },
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "2.0.x-dev"
+                    "dev-master": "1.0.x-dev"
                 }
             },
             "autoload": {
-                "psr-0": {
-                    "phpDocumentor": [
+                "psr-4": {
+                    "phpDocumentor\\Reflection\\": [
                         "src/"
                     ]
                 }
@@ -2085,39 +2236,39 @@
             "authors": [
                 {
                     "name": "Mike van Riel",
-                    "email": "mike.vanriel@naenius.com"
+                    "email": "me@mikevanriel.com"
                 }
             ],
-            "time": "2015-02-03 12:10:50"
+            "time": "2016-06-10 07:14:17"
         },
         {
             "name": "phpspec/prophecy",
-            "version": "v1.6.0",
+            "version": "v1.6.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/phpspec/prophecy.git",
-                "reference": "3c91bdf81797d725b14cb62906f9a4ce44235972"
+                "reference": "58a8137754bc24b25740d4281399a4a3596058e0"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/phpspec/prophecy/zipball/3c91bdf81797d725b14cb62906f9a4ce44235972",
-                "reference": "3c91bdf81797d725b14cb62906f9a4ce44235972",
+                "url": "https://api.github.com/repos/phpspec/prophecy/zipball/58a8137754bc24b25740d4281399a4a3596058e0",
+                "reference": "58a8137754bc24b25740d4281399a4a3596058e0",
                 "shasum": ""
             },
             "require": {
                 "doctrine/instantiator": "^1.0.2",
                 "php": "^5.3|^7.0",
-                "phpdocumentor/reflection-docblock": "~2.0",
-                "sebastian/comparator": "~1.1",
-                "sebastian/recursion-context": "~1.0"
+                "phpdocumentor/reflection-docblock": "^2.0|^3.0.2",
+                "sebastian/comparator": "^1.1",
+                "sebastian/recursion-context": "^1.0"
             },
             "require-dev": {
-                "phpspec/phpspec": "~2.0"
+                "phpspec/phpspec": "^2.0"
             },
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "1.5.x-dev"
+                    "dev-master": "1.6.x-dev"
                 }
             },
             "autoload": {
@@ -2150,7 +2301,7 @@
                 "spy",
                 "stub"
             ],
-            "time": "2016-02-15 07:46:21"
+            "time": "2016-06-07 08:13:47"
         },
         {
             "name": "phpunit/php-code-coverage",
@@ -2896,16 +3047,16 @@
         },
         {
             "name": "symfony/browser-kit",
-            "version": "v3.0.6",
+            "version": "v3.1.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/browser-kit.git",
-                "reference": "e07127ac31230b30887c2dddf3708d883d239b14"
+                "reference": "b645a9b23d6c0eeba5ac823fa87bf010db9aff22"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/browser-kit/zipball/e07127ac31230b30887c2dddf3708d883d239b14",
-                "reference": "e07127ac31230b30887c2dddf3708d883d239b14",
+                "url": "https://api.github.com/repos/symfony/browser-kit/zipball/b645a9b23d6c0eeba5ac823fa87bf010db9aff22",
+                "reference": "b645a9b23d6c0eeba5ac823fa87bf010db9aff22",
                 "shasum": ""
             },
             "require": {
@@ -2922,7 +3073,7 @@
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "3.0-dev"
+                    "dev-master": "3.1-dev"
                 }
             },
             "autoload": {
@@ -2949,20 +3100,20 @@
             ],
             "description": "Symfony BrowserKit Component",
             "homepage": "https://symfony.com",
-            "time": "2016-03-04 07:55:57"
+            "time": "2016-03-04 07:56:56"
         },
         {
             "name": "symfony/css-selector",
-            "version": "v3.0.6",
+            "version": "v3.1.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/css-selector.git",
-                "reference": "65e764f404685f2dc20c057e889b3ad04b2e2db0"
+                "reference": "c526d7b3cb4fe1673c6a34e13be2ff63f519df99"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/css-selector/zipball/65e764f404685f2dc20c057e889b3ad04b2e2db0",
-                "reference": "65e764f404685f2dc20c057e889b3ad04b2e2db0",
+                "url": "https://api.github.com/repos/symfony/css-selector/zipball/c526d7b3cb4fe1673c6a34e13be2ff63f519df99",
+                "reference": "c526d7b3cb4fe1673c6a34e13be2ff63f519df99",
                 "shasum": ""
             },
             "require": {
@@ -2971,7 +3122,7 @@
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "3.0-dev"
+                    "dev-master": "3.1-dev"
                 }
             },
             "autoload": {
@@ -3002,20 +3153,20 @@
             ],
             "description": "Symfony CssSelector Component",
             "homepage": "https://symfony.com",
-            "time": "2016-03-04 07:55:57"
+            "time": "2016-06-06 11:42:41"
         },
         {
             "name": "symfony/dom-crawler",
-            "version": "v3.0.6",
+            "version": "v3.1.1",
             "source": {
                 "type": "git",
                 "url": "https://github.com/symfony/dom-crawler.git",
-                "reference": "49b588841225b205700e5122fa01911cabada857"
+                "reference": "12aa63fd41b060d2bee9a34623d29eda70bc8fe3"
             },
             "dist": {
                 "type": "zip",
-                "url": "https://api.github.com/repos/symfony/dom-crawler/zipball/49b588841225b205700e5122fa01911cabada857",
-                "reference": "49b588841225b205700e5122fa01911cabada857",
+                "url": "https://api.github.com/repos/symfony/dom-crawler/zipball/12aa63fd41b060d2bee9a34623d29eda70bc8fe3",
+                "reference": "12aa63fd41b060d2bee9a34623d29eda70bc8fe3",
                 "shasum": ""
             },
             "require": {
@@ -3031,7 +3182,7 @@
             "type": "library",
             "extra": {
                 "branch-alias": {
-                    "dev-master": "3.0-dev"
+                    "dev-master": "3.1-dev"
                 }
             },
             "autoload": {
@@ -3058,7 +3209,56 @@
             ],
             "description": "Symfony DomCrawler Component",
             "homepage": "https://symfony.com",
-            "time": "2016-04-12 18:09:53"
+            "time": "2016-05-13 15:49:09"
+        },
+        {
+            "name": "webmozart/assert",
+            "version": "1.0.2",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/webmozart/assert.git",
+                "reference": "30eed06dd6bc88410a4ff7f77b6d22f3ce13dbde"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/webmozart/assert/zipball/30eed06dd6bc88410a4ff7f77b6d22f3ce13dbde",
+                "reference": "30eed06dd6bc88410a4ff7f77b6d22f3ce13dbde",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">=5.3.3"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "^4.6"
+            },
+            "type": "library",
+            "extra": {
+                "branch-alias": {
+                    "dev-master": "1.0-dev"
+                }
+            },
+            "autoload": {
+                "psr-4": {
+                    "Webmozart\\Assert\\": "src/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Bernhard Schussek",
+                    "email": "bschussek@gmail.com"
+                }
+            ],
+            "description": "Assertions to validate method input/output with nice error messages.",
+            "keywords": [
+                "assert",
+                "check",
+                "validate"
+            ],
+            "time": "2015-08-24 13:29:44"
         }
     ],
     "aliases": [],
diff --git a/config/nginx-app.conf b/config/nginx-app.conf
deleted file mode 100644
index c13edbf..0000000
--- a/config/nginx-app.conf
+++ /dev/null
@@ -1,4 +0,0 @@
-location / {
-  # try to serve file directly, fallback to front controller
-  try_files $uri /index.php$is_args$args;
-}
diff --git a/config/php-app.ini b/config/php-app.ini
deleted file mode 100644
index 45969d0..0000000
--- a/config/php-app.ini
+++ /dev/null
@@ -1 +0,0 @@
-extension=mongodb.so
diff --git a/config/php-pubsub.ini b/config/php-pubsub.ini
deleted file mode 100644
index 1f0dd17..0000000
--- a/config/php-pubsub.ini
+++ /dev/null
@@ -1,3 +0,0 @@
-extension=mongo.so
-extension=curl.so
-suhosin.executor.func.blacklist=
\ No newline at end of file
diff --git a/gce/deploy.sh b/gce/deploy.sh
new file mode 100644
index 0000000..61b2846
--- /dev/null
+++ b/gce/deploy.sh
@@ -0,0 +1,151 @@
+# Copyright 2015 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#! /bin/bash
+
+set -ex
+
+ZONE=us-central1-f
+
+GROUP=frontend-group
+TEMPLATE=$GROUP-tmpl
+MACHINE_TYPE=f1-micro
+STARTUP_SCRIPT=my-startup.sh
+IMAGE=ubuntu-15-04
+SCOPES="userinfo-email,\
+logging-write,\
+storage-full,\
+datastore,\
+https://www.googleapis.com/auth/projecthosting"
+TAGS=http-server
+
+MIN_INSTANCES=1
+MAX_INSTANCES=10
+TARGET_UTILIZATION=0.6
+
+SERVICE=frontend-web-service
+
+#
+# Instance group setup
+#
+
+# First we have to create an instance template.
+# This template will be used by the instance group
+# to create new instances.
+
+# [START create_template]
+gcloud compute instance-templates create $TEMPLATE \
+  --machine-type $MACHINE_TYPE \
+  --scopes $SCOPES \
+  --metadata-from-file startup-script=$STARTUP_SCRIPT \
+  --image $IMAGE \
+  --tags $TAGS
+# [END create_template]
+
+# Create the managed instance group.
+
+# [START create_group]
+gcloud compute instance-groups managed \
+  create $GROUP \
+  --base-instance-name $GROUP \
+  --size $MIN_INSTANCES \
+  --template $TEMPLATE \
+  --zone $ZONE
+# [END create_group]
+
+# [START create_named_port]
+gcloud compute instance-groups managed set-named-ports \
+    $GROUP \
+    --named-port http:8080 \
+    --zone $ZONE
+# [END create_named_port]
+
+#
+# Load Balancer Setup
+#
+
+# A complete HTTP load balancer is structured as follows:
+#
+# 1) A global forwarding rule directs incoming requests to a target HTTP proxy.
+# 2) The target HTTP proxy checks each request against a URL map to determine the
+#    appropriate backend service for the request.
+# 3) The backend service directs each request to an appropriate backend based on
+#    serving capacity, zone, and instance health of its attached backends. The
+#    health of each backend instance is verified using either a health check.
+#
+# We'll create these resources in reverse order:
+# service, health check, backend service, url map, proxy.
+
+# Create a health check
+# The load balancer will use this check to keep track of which instances to send traffic to.
+# Note that health checks will not cause the load balancer to shutdown any instances.
+
+# [START create_health_check]
+gcloud compute http-health-checks create ah-health-check \
+  --request-path /_ah/health
+# [END create_health_check]
+
+# Create a backend service, associate it with the health check and instance group.
+# The backend service serves as a target for load balancing.
+
+# [START create_backend_service]
+gcloud compute backend-services create $SERVICE \
+  --http-health-check ah-health-check
+# [END create_backend-service]
+
+# [START add_backend_service]
+gcloud compute backend-services add-backend $SERVICE \
+  --group $GROUP \
+  --zone $ZONE
+# [END add_backend_service]
+
+# Create a URL map and web Proxy. The URL map will send all requests to the
+# backend service defined above.
+
+# [START create_url_map]
+gcloud compute url-maps create $SERVICE-map \
+  --default-service $SERVICE
+# [END create_url_map]
+
+# [START create_http_proxy]
+gcloud compute target-http-proxies create $SERVICE-proxy \
+  --url-map $SERVICE-map
+# [END create_http_proxy]
+
+# Create a global forwarding rule to send all traffic to our proxy
+
+# [START create_forwarding_rule]
+gcloud compute forwarding-rules create $SERVICE-http-rule \
+  --global \
+  --target-http-proxy $SERVICE-proxy \
+  --port-range 80
+# [END create_forwarding_rule]
+
+#
+# Autoscaler configuration
+#
+# [START set_autoscaling]
+gcloud compute instance-groups managed set-autoscaling \
+  $GROUP \
+  --max-num-replicas $MAX_INSTANCES \
+  --target-load-balancing-utilization $TARGET_UTILIZATION \
+  --zone $ZONE
+# [END set_autoscaling]
+
+# [START create_firewall]
+gcloud compute firewall-rules create default-allow-http-8080 \
+    --allow tcp:8080 \
+    --source-ranges 0.0.0.0/0 \
+    --target-tags http-server \
+    --description "Allow port 8080 access to http-server"
+# [END create_firewall]
diff --git a/gce/fluentd/bookshelf.conf b/gce/fluentd/bookshelf.conf
new file mode 100644
index 0000000..98bd80e
--- /dev/null
+++ b/gce/fluentd/bookshelf.conf
@@ -0,0 +1,10 @@
+<source>
+  type tail
+  format none
+  path /opt/app/log/*.log
+  pos_file /var/tmp/fluentd.app.pos
+  read_from_head true
+  rotate_wait 10s
+  tag bookshelf
+</source>
+
diff --git a/gce/nginx/bookshelf.conf b/gce/nginx/bookshelf.conf
new file mode 100644
index 0000000..a54a9de
--- /dev/null
+++ b/gce/nginx/bookshelf.conf
@@ -0,0 +1,49 @@
+# Copyright 2015 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+server {
+    listen       80;
+    root         /opt/app/web;
+    index index.html index.htm index.php;
+
+    # Media: images, icons, video, audio, HTC
+    location ~* \.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ {
+      expires 10m;
+      access_log off;
+      etag on;
+      add_header Cache-Control "public";
+    }
+
+    # CSS and Javascript
+    location ~* \.(?:css|js)$ {
+      expires 10m;
+      access_log off;
+      etag on;
+      add_header Cache-Control "public";
+    }
+
+    # pass the PHP scripts to FastCGI server
+    location ~ \.php$ {
+      try_files $uri =404;
+      fastcgi_split_path_info ^(.+?\.php)(/.*)$;
+      fastcgi_pass unix:/var/run/php5-fpm.sock;
+      fastcgi_index index.php;
+      include fastcgi_params;
+    }
+
+    location / {
+      # try to serve file directly, fallback to front controller
+      try_files $uri /index.php$is_args$args;
+    }
+}
diff --git a/gce/nginx/fastcgi_params b/gce/nginx/fastcgi_params
new file mode 100644
index 0000000..417ff18
--- /dev/null
+++ b/gce/nginx/fastcgi_params
@@ -0,0 +1,41 @@
+# Copyright 2015 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+fastcgi_param   QUERY_STRING            $query_string;
+fastcgi_param   REQUEST_METHOD          $request_method;
+fastcgi_param   CONTENT_TYPE            $content_type;
+fastcgi_param   CONTENT_LENGTH          $content_length;
+
+fastcgi_param   SCRIPT_FILENAME         $document_root$fastcgi_script_name;
+fastcgi_param   SCRIPT_NAME             $fastcgi_script_name;
+fastcgi_param   PATH_INFO               $fastcgi_path_info;
+fastcgi_param   PATH_TRANSLATED         $document_root$fastcgi_path_info;
+fastcgi_param   REQUEST_URI             $request_uri;
+fastcgi_param   DOCUMENT_URI            $document_uri;
+fastcgi_param   DOCUMENT_ROOT           $document_root;
+fastcgi_param   SERVER_PROTOCOL         $server_protocol;
+
+fastcgi_param   GATEWAY_INTERFACE       CGI/1.1;
+fastcgi_param   SERVER_SOFTWARE         nginx/$nginx_version;
+
+fastcgi_param   REMOTE_ADDR             $http_x_real_ip;
+fastcgi_param   REMOTE_PORT             $remote_port;
+fastcgi_param   SERVER_ADDR             $server_addr;
+fastcgi_param   SERVER_PORT             $server_port;
+fastcgi_param   SERVER_NAME             $server_name;
+
+fastcgi_param   HTTPS                   $https;
+
+# PHP only, required if PHP was built with --enable-force-cgi-redirect
+fastcgi_param   REDIRECT_STATUS         200;
diff --git a/gce/startup-script.sh b/gce/startup-script.sh
new file mode 100644
index 0000000..bf6298c
--- /dev/null
+++ b/gce/startup-script.sh
@@ -0,0 +1,78 @@
+#!/bin/bash
+
+# Copyright 2015 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+# [START all]
+set -e
+export HOME=/root
+
+# [START php]
+# Install PHP and dependencies from apt
+apt-get update
+apt-get install -y git nginx mongodb-clients php5 php5-fpm php5-mysql php5-dev php-pear pkg-config
+pecl install mongodb
+
+# Enable the MongoDB PHP extension
+echo "extension=mongodb.so" >> /etc/php5/mods-available/mongodb.ini
+php5enmod mongodb
+
+# Install Composer
+curl -sS https://getcomposer.org/installer | \
+    /usr/bin/php -- \
+    --install-dir=/usr/local/bin \
+    --filename=composer
+
+# Fetch the project ID from the Metadata server
+PROJECTID=$(curl -s "http://metadata.google.internal/computeMetadata/v1/project/project-id" -H "Metadata-Flavor: Google")
+
+# Get the application source code
+git config --global credential.helper gcloud.sh
+git clone https://source.developers.google.com/p/$PROJECTID /opt/src -b master
+ln -s /opt/src/optional-compute-engine /opt/app
+
+# Run Composer
+composer install -d /opt/app --no-ansi --no-progress
+# [END php]
+
+# [START project_config]
+# Fetch the application config file from the Metadata server and add it to the project
+curl -s "http://metadata.google.internal/computeMetadata/v1/instance/attributes/project-config" \
+  -H "Metadata-Flavor: Google" >> /opt/app/config/settings.yml
+# [END project_config]
+
+# [START nginx]
+# Disable the default NGINX configuration
+rm /etc/nginx/sites-enabled/default
+
+# Enable our NGINX configuration
+cp /opt/app/gce/nginx/bookshelf.conf /etc/nginx/sites-available/bookshelf.conf
+ln -s /etc/nginx/sites-available/bookshelf.conf /etc/nginx/sites-enabled/bookshelf.conf
+cp /opt/app/gce/nginx/fastcgi_params /etc/nginx/fastcgi_params
+
+# Start NGINX
+systemctl restart nginx.service
+# [END nginx]
+
+# [START logging]
+# Install Fluentd
+curl -s "https://storage.googleapis.com/signals-agents/logging/google-fluentd-install.sh" | bash
+
+# Enable our Fluentd configuration
+cp /opt/app/gce/fluentd/bookshelf.conf /etc/google-fluentd/config.d/bookshelf.conf
+
+# Start Fluentd
+service google-fluentd restart &
+# [END logging]
+# [END all]
diff --git a/gce/teardown.sh b/gce/teardown.sh
new file mode 100644
index 0000000..7452db1
--- /dev/null
+++ b/gce/teardown.sh
@@ -0,0 +1,41 @@
+# Copyright 2015 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#! /bin/bash
+
+set -x
+
+ZONE=us-central1-f
+gcloud config set compute/zone $ZONE
+
+GROUP=frontend-group
+TEMPLATE=$GROUP-tmpl
+SERVICE=frontend-web-service
+
+gcloud compute instance-groups managed stop-autoscaling $GROUP --zone $ZONE
+
+gcloud compute forwarding-rules delete $SERVICE-http-rule --global 
+
+gcloud compute target-http-proxies delete $SERVICE-proxy 
+
+gcloud compute url-maps delete $SERVICE-map 
+
+gcloud compute backend-services delete $SERVICE 
+
+gcloud compute http-health-checks delete ah-health-check
+
+gcloud compute instance-groups managed delete $GROUP  
+
+gcloud compute instance-templates delete $TEMPLATE 
+
+gcloud compute firewall-rules delete default-allow-http-8080
diff --git a/test/app-e2e.yaml b/test/app-e2e.yaml
index dbeccdf..82b35ee 100644
--- a/test/app-e2e.yaml
+++ b/test/app-e2e.yaml
@@ -1,4 +1,4 @@
-runtime: custom
+runtime: php
 vm: true
 
 env_variables:
diff --git a/test/composer-mongodb.json b/test/composer-mongodb.json
index 63ded67..0823861 100644
--- a/test/composer-mongodb.json
+++ b/test/composer-mongodb.json
@@ -7,7 +7,6 @@
   "require": {
     "php": "~5.5.0|~5.6.0|~7.0.0",
     "google/apiclient": "~2.0@RC",
-    "google/cloud": "^0.2",
     "monolog/monolog": "^1.17",
     "mongodb/mongodb": "^1.0.0",
     "silex/silex": "^1.3",
diff --git a/test/lib/E2eTest.php b/test/lib/E2eTest.php
index bd5d22a..d18a503 100644
--- a/test/lib/E2eTest.php
+++ b/test/lib/E2eTest.php
@@ -30,6 +30,7 @@ abstract class E2eTest extends \PHPUnit_Framework_TestCase
 
     public static function setUpBeforeClass()
     {
+        // TODO: deploy to GCE
         if (self::$step = getenv('STEP_NAME')) {
             self::deployApp(self::$step, static::getCustomConfig());
         }
@@ -37,13 +38,12 @@ abstract class E2eTest extends \PHPUnit_Framework_TestCase
 
     public static function tearDownAfterClass()
     {
-        if (self::$step) {
-            self::deleteApp(self::$step);
-        }
+        // TODO: cleanup the resources
     }
 
     public function setUp()
     {
+        $this->markTestSkipped('Skipping for now.');
         if (!self::$step) {
             $this->markTestSkipped('must set STEP_NAME for e2e testing');
         }
diff --git a/worker.yaml b/worker.yaml
deleted file mode 100644
index 2695352..0000000
--- a/worker.yaml
+++ /dev/null
@@ -1,11 +0,0 @@
-#runtime: php
-vm: true
-service: worker
-# [START entrypoint]
-entrypoint: php bin/pubsub/entrypoint.php
-# [END entrypoint]
-
-# [START overrides]
-env_variables:
-  PHP_INI_OVERRIDE: config/php-pubsub.ini
-# [END overrides]
